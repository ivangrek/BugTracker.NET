@*
    Copyright 2002-2011 Corey Trager
    Copyright 2017-2019 Ivan Grek

    Distributed under the terms of the GNU General Public License
*@

@model BugTracker.Web.Models.SortableTableModel

@{
    var page = (BugTracker.Web.Models.PageModel)ViewBag.Page;

    ViewBag.Title = page.Title;
}

@section Head {
    @*TODO
        <body onload="filter_changed()">*@

    <script type="text/javascript" src="~/Scripts/sortable.js"></script>

    <script>
        function filter_changed() {
            el = document.getElementById("filter_users");

            if (el.value != "") {
                el.style.background = "yellow";
            } else {
                el.style.background = "white";
            }
        }
    </script>
}

@section BodyHeader {
    @Html.Partial("_MainMenu", page)
}

<div class="main">
    <a href="@Url.Action("Create", "User")"><img src="~/Content/images/add.png" align="top">&nbsp;add new user</a>

    <table border="0" width="80%">
        <tr>
            @*<td align="left" valign="top">
                    <a href="<%= ResolveUrl(" ~/Admin/Users/Edit.aspx")%>">add new user </a>
                </td>*@

            <td align="right" valign="top">
                <form runat="server">
                    <span class="lbl">Show only usernames starting with:</span>
                    <input type="text" runat="server" id="filter_users" class="txt" value="" onkeyup="filter_changed()" style="color: red;" />
                    &nbsp;&nbsp;&nbsp;

                    <span class="lbl">hide inactive users:</span>
                    <asp:CheckBox ID="hide_inactive_users" class="cb" runat="server" />

                    <input type="submit" class="btn" value="Refresh User List">
                </form>
            </td>
        </tr>
    </table>

    @if (Model.DataSet.Tables[0].Rows.Count > 0)
    {
        @Html.Partial("_SortableTable", Model);
    }
    else
    {
        <div>No users to display.</div>
    }
</div>

@section BodyFooter {
    @Html.Raw(BugTracker.Web.Core.Util.Context.Application["custom_footer"])
}
